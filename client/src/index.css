@tailwind base;
@tailwind components;
@tailwind utilities;

/* iOS Safe Area Support with Responsive Design */
:root {
  /* Safe area insets for iOS devices */
  --safe-area-inset-top: env(safe-area-inset-top);
  --safe-area-inset-right: env(safe-area-inset-right);
  --safe-area-inset-bottom: env(safe-area-inset-bottom);
  --safe-area-inset-left: env(safe-area-inset-left);
  
  /* Responsive spacing variables with clamp for better scaling */
  --header-height: clamp(60px, 12vh, 80px);
  --bottom-nav-height: clamp(60px, 12vh, 80px);
  --content-padding-x: clamp(12px, 4vw, 24px);
  --content-padding-y: clamp(8px, 2vh, 16px);
  --content-padding-bottom: clamp(12px, 3vh, 20px);
  --card-gap: clamp(8px, 2vw, 16px);
  
  /* Typography scaling */
  --text-xs: clamp(0.7rem, 2vw, 0.75rem);
  --text-sm: clamp(0.8rem, 2.5vw, 0.875rem);
  --text-base: clamp(0.9rem, 3vw, 1rem);
  --text-lg: clamp(1rem, 3.5vw, 1.125rem);
  --text-xl: clamp(1.1rem, 4vw, 1.25rem);
  --text-2xl: clamp(1.2rem, 5vw, 1.5rem);
}

/* Mobile optimization */
* {
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

input, textarea, button, select {
  -webkit-user-select: auto;
  -moz-user-select: auto;
  -ms-user-select: auto;
  user-select: auto;
}

/* Prevent zoom on iOS */
input[type="text"], input[type="email"], input[type="password"], textarea {
  font-size: 16px;
}

/* Smooth scrolling for mobile */
html {
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
  /* Prevent horizontal overflow */
  overflow-x: hidden;
}

/* Full viewport height handling for mobile browsers */
body {
  /* Use dynamic viewport units for better mobile support */
  min-height: 100dvh;
  overflow-x: hidden;
}

:root {
  --background: hsl(0, 0%, 100%);
  --foreground: hsl(222, 84%, 4.9%);
  --muted: hsl(210, 40%, 96%);
  --muted-foreground: hsl(215, 16%, 47%);
  --popover: hsl(0, 0%, 100%);
  --popover-foreground: hsl(222, 84%, 4.9%);
  --card: hsl(0, 0%, 100%);
  --card-foreground: hsl(222, 84%, 4.9%);
  --border: hsl(214, 32%, 91%);
  --input: hsl(214, 32%, 91%);
  --primary: hsl(174, 77%, 56%);
  --primary-foreground: hsl(0, 0%, 100%);
  --secondary: hsl(210, 40%, 96%);
  --secondary-foreground: hsl(222, 47%, 11%);
  --accent: hsl(210, 40%, 96%);
  --accent-foreground: hsl(222, 47%, 11%);
  --destructive: hsl(0, 84%, 60%);
  --destructive-foreground: hsl(0, 0%, 98%);
  --ring: hsl(174, 77%, 56%);
  --radius: 0.75rem;
  
  /* App specific colors */
  --app-surface: hsl(215, 28%, 17%);
  --app-surface-light: hsl(215, 25%, 27%);
  --app-text-primary: hsl(210, 40%, 98%);
  --app-text-secondary: hsl(215, 20%, 65%);
}

.dark {
  --background: hsl(215, 28%, 17%);
  --foreground: hsl(210, 40%, 98%);
  --muted: hsl(215, 25%, 27%);
  --muted-foreground: hsl(215, 20%, 65%);
  --popover: hsl(215, 28%, 17%);
  --popover-foreground: hsl(210, 40%, 98%);
  --card: hsl(215, 28%, 17%);
  --card-foreground: hsl(210, 40%, 98%);
  --border: hsl(215, 25%, 27%);
  --input: hsl(215, 25%, 27%);
  --primary: hsl(174, 77%, 56%);
  --primary-foreground: hsl(0, 0%, 100%);
  --secondary: hsl(215, 25%, 27%);
  --secondary-foreground: hsl(210, 40%, 98%);
  --accent: hsl(215, 25%, 27%);
  --accent-foreground: hsl(210, 40%, 98%);
  --destructive: hsl(0, 63%, 31%);
  --destructive-foreground: hsl(210, 40%, 98%);
  --ring: hsl(174, 77%, 56%);
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply font-sans antialiased;
    background: hsl(222, 84%, 4.9%);
    color: hsl(210, 40%, 98%);
  }

  /* Fix input and textarea text colors */
  input, textarea, select {
    color: #374151 !important;
  }

  input::placeholder, textarea::placeholder {
    color: #6b7280 !important;
  }

  /* Ensure date inputs are fully clickable */
  input[type="date"] {
    cursor: pointer;
    position: relative;
  }

  input[type="date"]::-webkit-calendar-picker-indicator {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: auto;
    height: auto;
    color: transparent;
    background: transparent;
    cursor: pointer;
  }

  .app-container {
    background: hsl(222, 84%, 4.9%);
    color: hsl(210, 40%, 98%);
  }

  .app-surface {
    background: hsl(215, 28%, 17%);
  }

  .app-surface-light {
    background: hsl(215, 25%, 27%);
  }

  .app-text-primary {
    color: hsl(210, 40%, 98%);
  }

  .app-text-secondary {
    color: hsl(215, 20%, 65%);
  }

  .app-primary {
    color: hsl(174, 77%, 56%);
  }

  .app-primary-bg {
    background: hsl(174, 77%, 56%);
  }

  .app-primary-bg-hover {
    background: hsl(174, 67%, 46%);
  }
}

/* Custom slider styling */
.intensity-slider::-webkit-slider-thumb {
  appearance: none;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: hsl(174, 77%, 56%);
  cursor: pointer;
  border: 2px solid white;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

.intensity-slider::-moz-range-thumb {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: hsl(174, 77%, 56%);
  cursor: pointer;
  border: 2px solid white;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

/* Tab active styling */
.tab-active {
  color: hsl(174, 77%, 56%);
}

/* iOS Safe Area Utilities */
.safe-area-pt {
  padding-top: max(20px, env(safe-area-inset-top));
}

.safe-area-pr {
  padding-right: max(20px, env(safe-area-inset-right));
}

.safe-area-pb {
  padding-bottom: max(20px, env(safe-area-inset-bottom));
}

.safe-area-pl {
  padding-left: max(20px, env(safe-area-inset-left));
}

.safe-area-p {
  padding: max(20px, env(safe-area-inset-top)) max(20px, env(safe-area-inset-right)) max(20px, env(safe-area-inset-bottom)) max(20px, env(safe-area-inset-left));
}

/* CSS Grid Layout for Better Space Distribution */
.app-container {
  display: grid;
  grid-template-rows: auto 1fr auto;
  min-height: 100vh;
  min-height: 100dvh; /* Dynamic viewport height for mobile */
  max-height: 100vh;
  max-height: 100dvh;
}

.viewport-height {
  height: 100vh;
  height: 100dvh; /* Dynamic viewport height for mobile */
}

.safe-container {
  padding-left: var(--content-padding-x);
  padding-right: var(--content-padding-x);
  padding-top: var(--content-padding-y);
  padding-bottom: var(--content-padding-bottom);
  max-width: 100%;
  margin: 0 auto;
}

.content-area {
  /* Optimized content area with minimal padding */
  padding-top: var(--content-padding-y);
  padding-bottom: var(--content-padding-bottom);
  overflow-y: auto;
  /* Enable momentum scrolling on iOS */
  -webkit-overflow-scrolling: touch;
}

.compact-header {
  /* Optimized header with modern design */
  padding: max(env(safe-area-inset-top), 12px) 16px 12px 16px;
  min-height: 60px;
  background: linear-gradient(135deg, #374151 0%, #2D3748 100%);
  display: flex;
  align-items: center;
  justify-content: center;
}

.compact-nav {
  /* Modern bottom navigation with optimized spacing */
  padding: 8px max(env(safe-area-inset-left), 16px) 
           max(env(safe-area-inset-bottom), 8px) 
           max(env(safe-area-inset-right), 16px);
  height: var(--bottom-nav-height);
  background: rgba(30, 41, 59, 0.95);
  backdrop-filter: blur(10px);
  border-top: 1px solid rgba(100, 116, 139, 0.2);
}

/* Touch Target Optimization */
.touch-target {
  min-height: 44px;
  min-width: 44px;
  touch-action: manipulation;
}

/* Enhanced Navigation Item Styles */
.nav-item {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-width: 0;
  min-height: 44px;
  padding: 6px 4px;
  border-radius: 8px;
  transition: all 0.2s ease;
  position: relative;
  cursor: pointer;
}

.nav-item:active {
  background-color: rgba(255, 255, 255, 0.1);
  transform: scale(0.95);
}

/* Active navigation indicator */
.nav-item.active::before {
  content: '';
  position: absolute;
  top: -2px;
  left: 50%;
  transform: translateX(-50%);
  width: 24px;
  height: 2px;
  background: #10B981;
  border-radius: 1px;
  transition: width 0.3s ease;
}

/* Responsive navigation container */
.bottom-navigation {
  display: flex;
  justify-content: space-between;
  gap: clamp(8px, 2vw, 16px);
  max-width: 420px;
  margin: 0 auto;
  padding: 0 clamp(8px, 2vw, 16px);
}

/* Responsive logo */
.logo {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: clamp(18px, 4vw, 22px);
  font-weight: 600;
}

/* Navigation icon and text sizing */
.nav-icon {
  width: clamp(18px, 4vw, 22px);
  height: clamp(18px, 4vw, 22px);
}

.nav-text {
  font-size: clamp(10px, 2.5vw, 12px);
  font-weight: 500;
  line-height: 1.2;
}

/* Device-Specific Responsive Breakpoints */

/* iPhone SE and smaller devices (320px - 568px height) */
@media (max-height: 568px) {
  :root {
    --header-height: clamp(50px, 10vh, 60px);
    --bottom-nav-height: clamp(50px, 10vh, 60px);
    --content-padding-y: clamp(4px, 1vh, 8px);
    --card-gap: clamp(4px, 1vw, 8px);
  }
  
  .safe-container {
    padding-top: var(--content-padding-y);
    padding-bottom: var(--content-padding-y);
  }
  
  .mobile-space-y-4 > * + * {
    margin-top: 0.5rem;
  }
  
  .mobile-space-y-6 > * + * {
    margin-top: 0.75rem;
  }
  
  .compact-nav {
    padding: 4px max(env(safe-area-inset-left), 12px) 
             max(env(safe-area-inset-bottom), 4px) 
             max(env(safe-area-inset-right), 12px);
  }
  
  .compact-header {
    min-height: 50px;
    padding: max(env(safe-area-inset-top), 8px) 12px 8px 12px;
  }
  
  .logo-text {
    font-size: 16px;
  }
  
  .nav-icon {
    width: 18px;
    height: 18px;
  }
  
  .nav-text {
    font-size: 10px;
  }
}

/* iPhone 13 mini specific optimizations (375px width, 812px height) */
@media (max-height: 812px) and (max-width: 375px) {
  :root {
    --header-height: clamp(55px, 11vh, 65px);
    --bottom-nav-height: clamp(55px, 11vh, 65px);
    --content-padding-x: clamp(10px, 3vw, 16px);
    --content-padding-y: clamp(6px, 1.5vh, 12px);
  }
  
  .safe-container {
    padding-left: var(--content-padding-x);
    padding-right: var(--content-padding-x);
  }
  
  /* Optimize card spacing for iPhone 13 mini */
  .space-y-6 > * + * {
    margin-top: 1rem;
  }
  
  .space-y-4 > * + * {
    margin-top: 0.75rem;
  }
}

/* Standard mobile devices */
@media (max-width: 768px) {
  .safe-container {
    padding-left: var(--content-padding-x);
    padding-right: var(--content-padding-x);
  }
  
  .mobile-space-y-4 > * + * {
    margin-top: var(--card-gap);
  }
  
  .mobile-space-y-6 > * + * {
    margin-top: calc(var(--card-gap) * 1.5);
  }
}

/* Larger iPhones (iPhone 13/14/15 Plus, Pro Max) */
@media (min-height: 900px) {
  :root {
    --header-height: clamp(70px, 14vh, 90px);
    --bottom-nav-height: clamp(70px, 14vh, 90px);
    --content-padding-y: clamp(12px, 3vh, 20px);
    --card-gap: clamp(12px, 3vw, 20px);
  }
  
  .mobile-space-y-6 > * + * {
    margin-top: 1.5rem;
  }
}

/* Responsive Typography Utilities */
.text-responsive-xs {
  font-size: var(--text-xs);
}

.text-responsive-sm {
  font-size: var(--text-sm);
}

.text-responsive-base {
  font-size: var(--text-base);
}

.text-responsive-lg {
  font-size: var(--text-lg);
}

.text-responsive-xl {
  font-size: var(--text-xl);
}

.text-responsive-2xl {
  font-size: var(--text-2xl);
}

/* Compact Cards for Mobile */
.card-compact {
  padding: var(--card-gap);
  margin-bottom: var(--card-gap);
  border-radius: clamp(8px, 2vw, 12px);
}

.card-compact-header {
  margin-bottom: calc(var(--card-gap) * 0.75);
}

.card-compact-content {
  line-height: 1.4;
}

/* Optimized form spacing */
.form-compact .space-y-4 > * + * {
  margin-top: var(--card-gap);
}

.form-compact .space-y-6 > * + * {
  margin-top: calc(var(--card-gap) * 1.5);
}

/* Button optimization for mobile */
.btn-compact {
  padding: calc(var(--card-gap) * 0.75) var(--card-gap);
  font-size: var(--text-sm);
  min-height: 44px;
  border-radius: clamp(6px, 1.5vw, 8px);
}

/* Prevent layout shift */
.layout-stable {
  contain: layout;
}

/* Smooth transitions */
.transition-smooth {
  transition: all 0.2s ease-in-out;
}

.safe-area-p {
  padding-top: var(--safe-area-inset-top);
  padding-right: var(--safe-area-inset-right);
  padding-bottom: var(--safe-area-inset-bottom);
  padding-left: var(--safe-area-inset-left);
}

/* Layout containers with safe areas */
.safe-container {
  padding-left: var(--content-padding-x);
  padding-right: var(--content-padding-x);
}

.safe-header {
  padding-top: var(--safe-area-inset-top);
  min-height: var(--header-height);
}

.safe-bottom-nav {
  padding-bottom: var(--safe-area-inset-bottom);
  min-height: var(--bottom-nav-height);
  /* Prevent iOS toolbar conflicts */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  /* Ensure fixed positioning doesn't conflict with iOS constraints */
  position: fixed;
  z-index: 50;
  left: 0;
  right: 0;
  bottom: 0;
  /* Use transform instead of absolute positioning to reduce constraint conflicts */
  transform: translateZ(0);
  will-change: transform;
}

/* Responsive viewport classes */
.viewport-height {
  height: 100dvh;
}

.content-area {
  min-height: calc(100dvh - var(--header-height) - var(--bottom-nav-height));
  padding-bottom: var(--bottom-nav-height);
}

/* Responsive breakpoints for tablets and larger screens */
@media screen and (min-width: 768px) {
  :root {
    --content-padding-x: max(24px, var(--safe-area-inset-left), var(--safe-area-inset-right));
    --content-padding-y: 24px;
  }
  
  .safe-container {
    max-width: 768px;
    margin: 0 auto;
  }
}

@media screen and (min-width: 1024px) {
  :root {
    --content-padding-x: max(32px, var(--safe-area-inset-left), var(--safe-area-inset-right));
    --content-padding-y: 32px;
  }
  
  .safe-container {
    max-width: 1024px;
  }
}

@media screen and (min-width: 1280px) {
  :root {
    --content-padding-x: max(40px, var(--safe-area-inset-left), var(--safe-area-inset-right));
    --content-padding-y: 40px;
  }
  
  .safe-container {
    max-width: 1200px;
  }
}

/* Orientation-specific adjustments */
@media screen and (orientation: landscape) and (max-height: 600px) {
  :root {
    --header-height: calc(48px + var(--safe-area-inset-top));
    --bottom-nav-height: calc(60px + var(--safe-area-inset-bottom));
    --content-padding-y: 12px;
  }
}

/* iPad specific adjustments */
@media screen and (min-width: 768px) and (min-height: 1024px) {
  .content-area {
    padding: var(--content-padding-y) 0;
  }
  
  /* Center content on larger screens */
  .card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 24px;
    max-width: 1200px;
    margin: 0 auto;
  }
}

/* Touch target sizing for better accessibility */
.touch-target {
  min-height: 44px;
  min-width: 44px;
}

/* Prevent content from hiding behind notch or home indicator */
.notch-safe {
  margin-top: var(--safe-area-inset-top);
}

.home-indicator-safe {
  margin-bottom: var(--safe-area-inset-bottom);
}
